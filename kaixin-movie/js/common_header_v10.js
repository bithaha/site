function sendkkpv(e){new Image(1,1).src=e+(-1!==e.indexOf("?")?"&":"?")+"rd="+Math.random()}function strLength(e){return e.replace(/[^\x00-\xff]/g,"xx").length}function strSub(e,t){var o=/[^\x00-\xff]/g;if(e.replace(o,"mm").length<=t)return e;for(var n=Math.floor(t/2),a=n;a<e.length;a++)if(e.substr(0,a).replace(o,"mm").length>=t)return e.substr(0,a)+"...";return e}function get_fufei_uerinfo_result(e){e.data.type>0&&($("#icon_con").append('<i class="icon icon_vipico_s"></i>'),$("#kkVipIcon")[0].className="icon icon_vip_s",$("#kkVipIcon").attr("href","http://vip.kankan.com/privilege.html"),$("#kkVipIcon").attr("title","影视VIP"),$("#get-vip").css("display","none"))}function getParameter(e){var t=document.location.search,o=new RegExp("[?&]"+e+"=([^&]+)","g"),n=o.exec(t),a=null;return null!=n&&(a=decodeURIComponent(n[1])),a}function strip_tags(html){if(arguments.length<3)html=html.replace(/<\/?(?!\!)[^>]*>/gi,"");else{var allowed=arguments[1],specified=eval("["+arguments[2]+"]");if(allowed){var regex="</?(?!("+specified.join("|")+"))\b[^>]*>";html=html.replace(new RegExp(regex,"gi"),"")}else{var regex="</?("+specified.join("|")+")\b[^>]*>";html=html.replace(new RegExp(regex,"gi"),"")}}var clean_string=html;return clean_string}function login_success_callback(){if(kkHeader.refresh(),"function"==typeof kkHeader.gLoginSuccess)try{kkHeader.gLoginSuccess()}catch(e){}}function login_close_callback(){if("function"==typeof kkHeader.gLoginClose)try{kkHeader.gLoginClose()}catch(e){}}function send_kkpgv2_pv_app_download(){var e=kkTool.Cookie.get("f_refer"),t=encodeURIComponent(document.referrer);t||"undefined"==typeof kkpgv_u9||(t=kkpgv_u9);var o=(parseInt(function(e){var t=document.location.search,o=new RegExp("[?&]"+e+"=([^&]+)","g"),n=o.exec(t),a=null;return null!=n&&(a=decodeURIComponent(n[1])),a}("id")),kkTool.Cookie.get("userid")&&kkTool.Cookie.get("sessionid")?parseInt(kkTool.Cookie.get("userid")):0),n=o>0&&parseInt(kkTool.Cookie.get("isvip"))>0?parseInt(kkTool.Cookie.get("isvip")):0,a=encodeURIComponent(navigator.userAgent),i=kkTool.getUsrPeerid()?kkTool.getUsrPeerid():"null",r=(kkTool.Cookie.get("qs_id"),kkTool.Cookie.get("kankanwebuid")),s=kkTool.Cookie.get("kankanwebsessionid");sendkkpv("http://kkpgv2.kankan.com/?u=kkshow&u1=www_app&u2=show&u4="+document.URL+"&u5="+e+"&u6="+t+"&u7="+a+"&u8="+r+"&u9="+i+"&u10="+o+"&u11="+s+"&u12="+n+"&rd="+Math.floor(99999*Math.random())+1)}function show_kk_pc(){var e=document.documentElement?document.documentElement.clientWidth:document.body.clientWidth;e=parseInt(e)-25,parseInt(e)>1420?document.getElementById("kk_pc_div").style.display="block":parseInt(e)>1180?document.getElementById("kk_pc_div").style.display="block":document.getElementById("kk_pc_div").style.display="none"}try{document.domain="kankan.com"}catch(e){}var kkPageFav={showFavNum:function(e){e>0?$("#fav_head").css("display","block"):$("#fav_head").css("display","none")}},MiniSite=MiniSite||{};MiniSite.Browser=MiniSite.Browser||{ie:/msie/.test(window.navigator.userAgent.toLowerCase()),moz:/gecko/.test(window.navigator.userAgent.toLowerCase()),opera:/opera/.test(window.navigator.userAgent.toLowerCase()),safari:/safari/.test(window.navigator.userAgent.toLowerCase())},MiniSite.loadJSData=MiniSite.loadJSData||function(e,t,o){var n=document.createElement("script");n.setAttribute("charset",t),n.setAttribute("type","text/javascript"),n.setAttribute("src",e),document.getElementsByTagName("head")[0].appendChild(n),MiniSite.Browser.ie?n.onreadystatechange=function(){"loaded"!==this.readyState&&"complete"!==this.readyState||setTimeout(function(){try{o()}catch(e){}},50)}:MiniSite.Browser.moz?n.onload=function(){setTimeout(function(){try{o()}catch(e){}},50)}:setTimeout(function(){try{o()}catch(e){}},50)},window.kkTool={},window.kkTool.strSub=function(e,t){var o=/[^\x00-\xff]/g;if(e.replace(o,"mm").length<=t)return e;for(var n=Math.floor(t/2),a=n;a<e.length;a++)if(e.substr(0,a).replace(o,"mm").length>=t)return e.substr(0,a)+"...";return e},window.kkTool.MiniSite=MiniSite,window.kkTool.getUsrPeerid=function(){var e,t,o;try{e=new ActiveXObject("DapCtrl.DapCtrl")}catch(e){return function(){return null}}t=e;try{o=t.Get("sPeerID")||null}catch(e){}return function(){return o}}(),kkTool.Cookie={get:function(e){try{return null==document.cookie.match(new RegExp("(^"+e+"| "+e+")=([^;]*)"))?"":decodeURIComponent(RegExp.$2)}catch(e){return""}},del:function(e,t){var o=new Date((new Date).getTime()),t=t||(-1!=window.location.host.indexOf("xunlei.com")?"xunlei.com":"kankan.com");document.cookie=e+"= ; path=/; domain="+t+"; expires="+o.toGMTString()},set:function(e,t,o,n){var n=n||(-1!=window.location.host.indexOf("xunlei.com")?"xunlei.com":"kankan.com");if(arguments.length>2){var a=new Date((new Date).getTime()+36e5*o);document.cookie=e+"="+encodeURIComponent(t)+"; path=/; domain="+n+"; expires="+a.toGMTString()}else document.cookie=e+"="+encodeURIComponent(t)+"; path=/; domain="+n}},kkTool.Event={add:function(e,t,o,n){if(n=!!n,e.addEventListener)return e.addEventListener(t,o,n),!0;if(e.attachEvent){return e.attachEvent("on"+t,o)}e["on"+t]=o},remove:function(e,t,o){e.detachEvent?e.detachEvent("on"+t,o):e.removeEventListener?e.removeEventListener(t,o,!1):e["on"+t]=null}},kkTool.Dom={$:function(e){return document.getElementById(e)},C:function(e){return document.createElement(e)},P:function(e,t){return t?t.appendChild(e):document.body.insertBefore(e,document.body.firstChild)},R:function(e){return e.parentNode.removeChild(e)}},kkTool.getScript=function(url,handler,args,isDestory,charset,interval){var head=document.getElementsByTagName("head")[0],script=document.createElement("script"),id="dynamic_script_"+(new Date).getTime()+"_"+Math.random(),eventType=void 0!==script.onreadystatechange&&void 0!==script.readyState?"readystatechange":"load";script.language="javascript",script.type="text/javascript",void 0===args&&(args=[]),void 0!==charset&&(script.charset=charset);var needCountTime=!1;void 0!==interval&&(needCountTime=!0);var intvId=null,isLoaded=!1;script.src=url,script.id=id,kkTool.Event.add(script,eventType,function(){var state=script.readyState||"loaded";"loaded"!=state&&"complete"!=state||(null!=intvId&&(clearTimeout(intvId),intvId=null),isLoaded||(isLoaded=!0,args.unshift(!0),"string"==typeof handler?setTimeout(function(){try{var hdl=eval(handler);hdl.apply(null,args)}catch(e){}},50):"function"==typeof handler&&setTimeout(function(){handler.apply(null,args)},50)),isDestory&&kkTool.Dom.R(script,head),head=null,script=null)}),kkTool.Dom.P(script,head),needCountTime&&(intvId=setTimeout(function(){clearTimeout(intvId),intvId=null,isLoaded||(isLoaded=!0,args.unshift(!1),"string"==typeof handler?setTimeout(function(){try{var hdl=eval(handler);hdl.apply(null,args)}catch(e){}},50):"function"==typeof handler&&setTimeout(function(){try{handler.apply(null,args)}catch(e){}},50))},interval))},kkTool.getShowName=function(){return""!=getCookie("kk_nickname")?mc_usrname=getCookie("kk_nickname"):""!=decodeURIComponent(getCookie("usernick"))?mc_usrname=decodeURIComponent(getCookie("usernick")):""!=getCookie("usrname")?mc_usrname=getCookie("usrname"):mc_usrname=getCookie("usernewno"),decodeURIComponent(mc_usrname)},void 0===window.kkHeader&&(window.kkHeader={}),kkHeader.autoLogin={init:function(){kkTool.getScript("http://u.kankan.com/login/1.0.4.min.js",function(){xlQuickLogin.init({loginID:"107",UIStyle:"http://misc.web.kankan.com/kankan_login/css/style.css",closeFunc:function(){try{login_close_callback()}catch(e){}},loginFunc:function(){kkLoginFrame.global_login_notice_add_exp();try{login_success_callback()}catch(e){}},loginedFunc:function(){if(kkHeader.refresh(),"function"==typeof kkHeader.gAutoLoginSuccess)try{kkHeader.gAutoLoginSuccess()}catch(e){}},logoutFunc:function(){kkHeader.tNotify.logout()}},[],!1,"utf-8")})}},kkHeader.userInfo={uid:0,nick:"",is_vip:0,v_level:0,inited:0,init:function(){var e=kkTool.Cookie.get("userid"),t=kkTool.Cookie.get("sessionid");if(this.uid=e||0,this.uid>0&&""!=t)try{this.nick=decodeURIComponent(kkTool.Cookie.get("usernick"))}catch(e){this.nick=kkTool.Cookie.get("usernick")}},setNick:function(e){e&&(this.nick=e)}},kkHeader.tNotify={display:!1,display2:!1,load:function(){var e=kkHeader.userInfo.uid;if(!e)return void kkHeader.tNotify.showLogPanel();try{kkTool.getScript("http://api.t.kankan.com/kknotify.json?jsobj=G_SSUser&userid="+e+"&r="+(new Date).getTime(),function(e){kkHeader.tNotify.changeShuoshuoStatus()},[],!1,"utf-8")}catch(e){}kkHeader.tNotify.showUserPanel()},changeShuoshuoStatus:function(){if("undefined"!=typeof G_SSUser)if(200==G_SSUser.status){var e=G_SSUser.data.user.nickname,t=G_SSUser.data.count<=99?G_SSUser.data.count:"99+",o=(G_SSUser.data.user.avatar,{});o.newfans=G_SSUser.data.type_count.newfans<=99?G_SSUser.data.type_count.newfans:"99+",o.comment=G_SSUser.data.type_count.comment<=99?G_SSUser.data.type_count.comment:"99+",o.feeds_at=G_SSUser.data.type_count.feeds_at<=99?G_SSUser.data.type_count.feeds_at:"99+",o.comment_at=G_SSUser.data.type_count.comment_at<=99?G_SSUser.data.type_count.comment_at:"99+",o.paper_follow=G_SSUser.data.type_count.paper_follow<=99?G_SSUser.data.type_count.paper_follow:"99+",o.vote_me=G_SSUser.data.type_count.vote_me<=99?G_SSUser.data.type_count.vote_me:"99+",o.system_notice=G_SSUser.data.type_count.system_notice<=99?G_SSUser.data.type_count.system_notice:"99+",o.paper_attentioned=G_SSUser.data.type_count.paper_attentioned<=99?G_SSUser.data.type_count.paper_attentioned:"99+"}else var e=kkTool.getShowName(),t=0,o={newfans:0,comment:0,feeds_at:0,comment_at:0,paper_follow:0,vote_me:0,system_notice:0,paper_attentioned:0};else var e=kkTool.getShowName(),t=0,o={newfans:0,comment:0,feeds_at:0,comment_at:0,paper_follow:0,vote_me:0,system_notice:0,paper_attentioned:0};var n=(G_SSUser.data.level.long_icon,"<span>"+kkTool.strSub(e+"",6)+"</span>");parseInt(t)>0&&$("#icon_con").append('<i class="icon icon_tips"></i>');var a='<div class="userinfo_top"><a target="_blank" href="http://t.kankan.com/app/profile?t=post" title="个人主页" class="pic"><img src="'+G_SSUser.data.user.avatar50+'"></a><p>等级：'+G_SSUser.data.level.level+' <a target="_blank" href="http://t.kankan.com/app/level?action=mylev">去成长中心</a></p><p>经验：'+G_SSUser.data.level.exp+"，还需"+G_SSUser.data.level.exp_leave+"升级</p><p>金币："+G_SSUser.data.coin+' <a target="_blank" href="http://t.kankan.com/app/store">立即兑换</a></p></div><p class="userinfo_tip"><strong>新通知<em>('+t+')</em></strong><a target="_blank" href="http://t.kankan.com/app/profile?t=notify&a=comment">历史通知</a></p><ul class="userinfo_list">';parseInt(o.newfans)>0&&(a+='<li><a target="_blank" href="http://t.kankan.com/'+kkTool.Cookie.get("userid")+'/fans?notify=1">'+o.newfans+"个新粉丝</a></li>"),parseInt(o.comment)>0&&(a+='<li><a target="_blank" href="http://t.kankan.com/app/profile?t=notify&a=comment">'+o.comment+"条新评论/回应</a></li>"),parseInt(o.vote_me)>0&&(a+='<li><a target="_blank" href="http://t.kankan.com/app/profile?t=notify&a=vote_me">'+o.vote_me+"条新赞同</a></li>"),parseInt(o.paper_attentioned)>0&&(a+='<li><a target="_blank" href="http://t.kankan.com/">'+o.paper_attentioned+"个我关注的</a></li>"),parseInt(o.feeds_at)>0&&(a+='<li><a target="_blank" href="http://t.kankan.com/app/profile?t=notify&a=feeds_at">'+o.feeds_at+"条@我的动态</a></li>"),parseInt(o.comment_at)>0&&(a+='<li><a target="_blank" href="http://t.kankan.com/app/profile?t=notify&a=comment_at">'+o.comment_at+"条@我的评论</a></li>"),parseInt(o.paper_follow)>0&&(a+='<li><a target="_blank" href="http://t.kankan.com/app/profile?t=notify&a=paper_follow">'+o.paper_follow+"个关注我的小报</a></li>"),parseInt(o.system_notice)>0&&(a+='<li><a target="_blank" href="http://t.kankan.com/app/profile?t=notify&a=system_notice">'+o.system_notice+"条系统通知</a></li>"),a+="</ul>",a+='<div class="dropcon_bottom">',a+='<a href="http://vip.kankan.com/pay_vip.shtml?refer=privilege" target="_blank" title="点击开通影视VIP" class="" id="kkVipIcon">点击开通影视VIP</a>',a+='<a id="kkuser_logout" href="javascript://" onclick="xlQuickLogin.logout();return false;" target="_self" class="dropcon_bottom_btn">退出</a><a id="kkuser_setting" href="http://t.kankan.com/'+G_SSUser.data.user.userid+'/info#type=edit" target="_blank" class="dropcon_bottom_btn">帐号设置</a></div>',$("#user-name").html(n),$("#user-msg").html(a),$("#user-pic").attr("src",G_SSUser.data.user.avatar40),$("#no-login").css("display","none"),$("#dropbox_user_tigger").css("display","block"),$("#dropbox_user_tigger_ifm").css("display",""),window.kkTool.MiniSite.loadJSData("http://busi.vip.kankan.com/userinfo/getUserInfoKanKanWeb?callback=get_fufei_uerinfo_result&rd="+Math.random(),"utf-8",function(){})},showLogPanel:function(){$("#no-login").css("display","block"),$("#user-name").html(""),$("#user-msg").html(""),$("#nav_user_box").attr("class","dropbox dropbox_user"),$("#dropbox_user_tigger").css("display","none"),$("#dropbox_user_tigger_ifm").css("display","none"),$("#dropbox_vip").css("display","block")},showUserPanel:function(){$("#no-login").css("display","none"),$("#dropbox_user_tigger").css("display",""),$("#dropbox_user_tigger_ifm").css("display","")},logout:function(){if(kkTool.Cookie.del("usernick"),kkTool.Cookie.del("isvip"),kkTool.Cookie.del("sessionid"),kkTool.Cookie.del("lsessionid"),kkTool.Cookie.del("luserid"),kkTool.Cookie.del("usrname"),kkTool.Cookie.del("usernewno"),kkTool.Cookie.del("userid"),kkTool.Cookie.del("nickname"),kkTool.Cookie.del("uservip"),kkHeader.userInfo.uid=0,kkHeader.userInfo.nick="",kkHeader.userInfo.inited=0,kkHeader.userInfo.is_vip=0,kkHeader.userInfo.v_level=0,kkHeader.tNotify.showLogPanel(),kkHeader.loadHisFront(),kkHeader.loadFavFront(),$("#icon_con").html('<img id="user-pic" width="26" height="26" src="">'),$("#get-vip").css("display","block"),$("#dropbox_user_tigger").removeClass("dropbox_on"),"function"==typeof kkHeader.gLogoutSuccess)try{kkHeader.gLogoutSuccess()}catch(e){}return!0}},kkHeader.showHisFront=function(){$("#historyfront").attr("src")||$("#historyfront").attr("src","http://movie.kankan.com/history/show_v2.html")},kkHeader.reLoadHisFront=function(){$("#historyfront").attr("src","http://movie.kankan.com/history/show_v2.html")},kkHeader.hideHisLoading=function(){$("#historyloading").css("display","none"),$("#historyfront").css("display","block")},kkHeader.loadHisFront=function(){void 0!==$("#historyfront")[0].contentWindow.userinfo&&$("#historyfront")[0].contentWindow.viewHistory.init()},kkHeader.showFavFront=function(){$("#favfront").attr("src")||$("#favfront").attr("src","http://movie.kankan.com/history/fav.html")},kkHeader.reLoadFavFront=function(){$("#favfront").attr("src","http://movie.kankan.com/history/fav.html")},kkHeader.hideFavLoading=function(){$("#favloading").css("display","none"),$("#favfront").css("display","block")},kkHeader.setFavFrontSize=function(e){$(".dropcon_favs, #favfront").css("height",e)},kkHeader.loadFavFront=function(){void 0!==kkTool.Dom.$("favfront").contentWindow.favList&&kkTool.Dom.$("favfront").contentWindow.favList.init()},kkHeader.refresh=function(){kkHeader.userInfo.init(),kkHeader.tNotify.load(),kkHeader.loadHisFront(),kkHeader.showFavFront()},kkHeader.init=function(){kkHeader.autoLogin.init()};var Login={};Login.Show=function(){global_login_frm_show("list"),"function"==typeof kkHeader.gLoginBefore&&kkHeader.gLoginBefore()},setTimeout(function(){kkHeader.init()},0),$("#dropbox_user_tigger").hover(function(){var e=$(this),t=e.find("#dropbox_user_tigger_ifm"),o=t.prev();e.addClass("dropbox_on"),t.css({width:o.outerWidth(),height:o.height()})},function(){$(this).removeClass("dropbox_on")}),$("#history_div").hover(function(){$(this).addClass("dropbox_on"),kkHeader.showHisFront(),setTimeout(function(){void 0!==$("#historyfront")[0].contentWindow.viewHistory&&$("#historyfront")[0].contentWindow.viewHistory.send_kkpgv2_pv()},300)},function(){$(this).removeClass("dropbox_on")}),$("#fav_div").hover(function(){var e=$(this),t=e.find("iframe.favs_iframe"),o=t.prev();e.addClass("dropbox_on"),kkHeader.showFavFront(),setTimeout(function(){void 0!==$("#favfront")[0].contentWindow.favList&&$("#favfront")[0].contentWindow.favList.send_kkpgv2_pv()},300),t.css({width:o.outerWidth(),height:o.height()})},function(){$(this).removeClass("dropbox_on")}),$("#app_download_div").hover(function(){$(this).addClass("dropbox_on"),send_kkpgv2_pv_app_download()},function(){$(this).removeClass("dropbox_on")}),$("#contribute_div").hover(function(){$(this).addClass("dropbox_on")},function(){$(this).removeClass("dropbox_on")}),show_kk_pc();