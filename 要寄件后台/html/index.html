<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="author" content="JasonMa@anapp">
	<link href="favicon.ico" rel="bookmark" type="image/x-icon" /> 
	<link href="favicon.ico" rel="icon" type="image/x-icon" /> 
	<link href="favicon.ico" rel="shortcut icon" type="image/x-icon" />
	<link href="favicon.ico" rel="apple-touch-icon-precomposed" /> 
	<title>后台管理系统demo页面  列表</title>
	<link href="../css/bootstrap.css" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="../assets/layui/css/layui.css"  />
	<link href="../assets/layui/css/modules/code.css" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="../assets/icheck/icheck.css" />
	<link rel="stylesheet" type="text/css" href="../assets/webuploader/0.1.5/webuploader.css"  />
	<link rel="stylesheet" type="text/css" href="../assets/datetimepicker/jquery.datetimepicker.css"  />
	<link href="../css/my_plugins.css" rel="stylesheet">  
	<link href="../css/admin/framework.css" rel="stylesheet">
	<link href="../css/admin/common.css" rel="stylesheet"> 
	<link href="../css/admin.css" rel="stylesheet">
	<style type="text/css">
		.accordion {
		 	width: 100%;
		 	max-width: 360px;
		 	margin: 0px auto 20px;
		 	background: #37424F;
		 	color:#FFF; 
		 	-webkit-border-radius: 0px;
		 	-moz-border-radius: 0px;
		 	border-radius: 0px;
		 } 
		
		.accordion .link {
			cursor: pointer;
			display: block;
			padding: 15px 15px 15px 42px;
			color: #FFF; 
			font-size: 14px; 
			position: relative; 
			-webkit-transition: all 0.4s ease;
			-o-transition: all 0.4s ease;
			transition: all 0.4s ease;
		}
		 
		.accordion li:last-child .link {
			border-bottom: 0;
		}
		
		.accordion .link i {
			position: absolute;
			top: 16px;
			left: 12px;
			font-size: 18px;
			color: #FFF;
			-webkit-transition: all 0.4s ease;
			-o-transition: all 0.4s ease;
			transition: all 0.4s ease;
		}
		
		.accordion li i.fa-chevron-down {
			right: 12px;
			left: auto;
			font-size: 16px;
		}
		
		.accordion li.open .link {
			color: #FFF;
		}
		
		.accordion li.open i {
			color: #FFF;
		}
		.accordion li.open i.fa-chevron-down {
			-webkit-transform: rotate(180deg);
			-ms-transform: rotate(180deg);
			-o-transform: rotate(180deg);
			transform: rotate(180deg);
		}
		
		/**
		 * Submenu
		 -----------------------------*/
		 .submenu {
		 	display: none;
		 	background: #000;
		 	font-size: 14px;
		 }
		
		 .submenu li i{
		 	color:#FFF;
			font-size: 15px;
			color: #FFF;
			margin-right:5px;   
			-webkit-transition: all 0.4s ease;
			-o-transition: all 0.4s ease;
			transition: all 0.4s ease;  
		 } 
		
		 .submenu a {
		 	display: block;
		 	text-decoration: none;
		 	color: #d9d9d9;
		 	padding: 12px;
		 	padding-left: 25px;
		 	-webkit-transition: all 0.25s ease;
		 	-o-transition: all 0.25s ease;
		 	transition: all 0.25s ease;
		 }
		 
		 .submenu a.active {
		    background-color: #09C;
		 }
		
		 .submenu a:hover { 
		 	background: #0099CC;
		 	color: #FFF;
		 }
	</style>
</head>
<body>
	<nav class="nav navbar-default navbar-mystyle navbar-fixed-top">
		<div class="navbar-header">
			<button class="navbar-toggle" data-toggle="collapse"
				data-target=".navbar-collapse">
				<span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
			</button>
			<a class="navbar-brand mystyle-brand"><img width="93" src="../img/logo.png"/></a>
		</div>
		<div class="collapse navbar-collapse">
			<ul class="nav navbar-nav">
				<li class="li-border"><a class="mystyle-color" href="#">管理控制台</a></li>
			</ul>
	
			<ul class="nav navbar-nav pull-right">
				<li class="dropdown li-border">
					<a href="#" class="dropdown-toggle mystyle-color" data-toggle="dropdown">
						<i class="sublist-icon layui-icon">&#xe612;</i>
						yang.yun
						<span class="caret"></span>
					</a>
					<ul class="dropdown-menu">
						<li><a href="#">登录密码</a></li>
						<li class="divider"></li>
						<li><a href="#">退出</a></li> 
					</ul>
				</li>
			</ul>
		</div>
	</nav>
	<div class="down-main">
		<div class="left-main left-full">
			<ul id="accordion" class="accordion">
				<li>
					<div class="link"><i class="layui-icon">&#xe614;</i>系统管理<i class="fa fa-chevron-down"></i></div>
					<ul class="submenu">
						<li><a href="#" data-tab="item1-1"><i class="layui-icon">&#xe614;</i>管理员列表</a></li>
						<li><a href="#" data-tab="item1-2"><i class="layui-icon">&#xe614;</i>系统设置</a></li>
					</ul>
				</li>
				<li>
					<div class="link"><i class="layui-icon">&#xe613;</i>合伙人信息<i class="fa fa-chevron-down"></i></div>
					<ul class="submenu">
						<li><a href="#" data-tab="item5-2"><i class="layui-icon">&#xe643;</i>合伙人列表</a></li>
						<li><a href="#" data-tab="item5-1"><i class="layui-icon">&#xe643;</i>忘记密码申请</a></li>
					</ul>
				</li>
				<li>
					<div class="link"><i class="layui-icon">&#xe62c;</i>商品信息<i class="fa fa-chevron-down"></i></div>
					<ul class="submenu">
						<li><a href="#" data-tab="item6-1"><i class="layui-icon">&#xe643;</i>商品列表</a></li>
					</ul>
				</li>
				<li>
					<div class="link"><i class="layui-icon">&#xe634;</i>在线订单<i class="fa fa-chevron-down"></i></div>
					<ul class="submenu">
						<li><a href="#" data-tab="item2-1"><i class="layui-icon">&#xe643;</i>订单列表</a></li>
						<li><a href="#" data-tab="item2-2"><i class="layui-icon">&#xe643;</i>提现申请</a></li>
					</ul>
				</li>
				<li>
					<div class="link"><i class="layui-icon">&#xe641;</i>其他信息<i class="fa fa-chevron-down"></i></div>
					<ul class="submenu">
						<li><a href="#" data-tab="item8-1"><i class="layui-icon">&#xe643;</i>非法词管理</a></li>
						<li><a href="#" data-tab="item8-2"><i class="layui-icon">&#xe643;</i>招募海报</a></li>
						<li><a href="#" data-tab="item8-3"><i class="layui-icon">&#xe643;</i>乐生活</a></li>
						<li><a href="#" data-tab="item8-4"><i class="layui-icon">&#xe643;</i>分销政策</a></li>
						<li><a href="#" data-tab="item8-5"><i class="layui-icon">&#xe643;</i>酵素常识</a></li>
						<li><a href="#" data-tab="item8-6"><i class="layui-icon">&#xe643;</i>酵素视屏</a></li>
					</ul>
				</li>
				<li>
					<div class="link"><i class="layui-icon">&#xe606;</i>微信配置<i class="fa fa-chevron-down"></i></div>
					<ul class="submenu">
						<li><a href="#" data-tab="item9-1"><i class="layui-icon">&#xe63a;</i>自定义菜单</a></li>
						<!-- <li><a href="admin/clickeylist" data-tab="item9-2"><i class="layui-icon">&#xe63a;</i>事件列表</a></li> -->
						<li><a href="#" data-tab="item9-3"><i class="layui-icon">&#xe63a;</i>资源管理</a></li>
						<li><a href="#" data-tab="item9-4"><i class="layui-icon">&#xe63a;</i>自动回复</a></li>
					</ul>
				</li>
			</ul>
		</div>
		<div class="right-content view-product right-full">
			<div id="listPanel"> 
				<blockquote class="layui-elem-quote toolbar">
					<span style="display: block;" class="layui-breadcrumb">
					   <a href="javascript:void(0);" onclick="history();">系统管理</a>
					   <a><cite>管理员列表</cite></a>
					</span>
				</blockquote>
				<div class="r-page">
					<div class="search-panel" style="width: 900px;">
						<form id="queryForm" class="searsh-form form-inline" autocomplete="off">
						  <div class="form-group">
						    <input type="text" class="form-control" id="sh-userName" name="queryStr" placeholder="用户名">
						    <input type="text" style="display:none;">
						  </div>
						  <div class="btn btn-default" onclick="queryClick();">查询</div> 
						  <input type="hidden" id="curPage" name="curPage" value="1">
						  <input type="hidden" id="pageSize" name="pageSize" value="10">
						</form>
					</div>
					<div id="datatable" class="ma" style="width: 900px;">
						<div class="datatable-panel panel panel-default">
							<table class="table table-hover">
								<thead class="dt-theadtr" style="display: table-header-group;">
									<tr class="dt-theadtr">
										<th data-type="checkbox" data-dtname="" style="width:20px;"><input class="checkbox-selectall" type="checkbox"></th>
								        <th data-type="text" data-dtname="rownum" style="width:20px;">#</th>
								        <th data-type="text" data-dtname="userName">用户名</th>
								        <th data-type="operation" data-opname="edit">操作</th>
							        </tr>
								</thead>
								<tbody class="dt-tbody">
								</tbody>
							</table>
						</div>
						<div class="table-footer clearfix">
							<div class="btn-bar">
								<div class="btn btn-success" onclick="showAddPanel();">添加</div>
								<div class="btn btn-danger" onclick="removeObjects();">删除</div>
							</div>
							<ul class="my-pagination clearfix"></ul>
						</div>
					</div>
				</div>
			</div>
			<jsp:include page="/jsp/admin/admin_add.jsp"/>
			<input type="hidden" value="11111" id="hid_adminId"/>
		</div>
	</div>
	<div class="toast-bar"><ul></ul></div>
	<div id="maskDiv" class="ma mask-div"></div>
	<div id="maAlert" class="ma alert">
		<div class="content">保存成功!</div>
		<div class="btn-bar">
			<div class="alt-btn close-btn">确定</div>
		</div>
	</div>
	
	<div id="maConfirm" class="ma confirm alert">
		<div class="content">保存成功!</div>
		<div class="btn-bar">
			<div class="alt-btn cancel-btn">取消</div>
			<div class="alt-btn ok-btn">确定</div>
		</div>
	</div>
	
	<div id="city-selector-panel">
		<div class="city-tabs">
			<div id="city-tab-province" class="city-tab active">请选择</div>
			<div id="city-tab-city" class="city-tab">请选择</div>
			<div id="city-tab-county" class="city-tab">请选择</div>
		</div>
		<ul id="city-panel-province" class="city-panel clearfix"></ul>
		<ul id="city-panel-city" class="city-panel clearfix"></ul>
		<ul id="city-panel-county" class="city-panel clearfix"></ul>
	</div>
	<div id="maAlert" class="ma alert">
		<div class="content">保存成功!</div>
		<div class="btn-bar">
			<div class="alt-btn close-btn">确定</div>
		</div>
	</div>
	<div id="maConfirm" class="ma confirm alert">
		<div class="content">保存成功!</div>
		<div class="btn-bar">
			<div class="alt-btn cancel-btn">取消</div>
			<div class="alt-btn ok-btn">确定</div>
		</div>
	</div>
	<script src="../js/vendor/jquery/jquery-1.11.3.min.js"></script>
	<script src="../js/vendor/jquery/jquery-ui-1.10.4.js"></script>
	<script src="../js/vendor/jquery/jquery.fileupload.js"></script>
	<script src="../js/vendor/jquery/jquery.cookie.js"></script>
	<script src="../js/vendor/jsrender.js"></script>
	<script src="../js/bootstrap.js"></script>
	<script type="text/javascript" src="../assets/layer/2.1/layer.js"></script>
	<script type="text/javascript" src="../assets/layui/layui.js"></script>
	<script type="text/javascript" src="../assets/icheck/jquery.icheck.min.js"></script> 
	<script type="text/javascript" src="../assets/webuploader/0.1.5/webuploader.min.js"></script>
	<script type="text/javascript" src="../assets/datetimepicker/jquery.datetimepicker.js"></script>
	
	<script src="../js/my_plugins.js"></script>
	<script src="../js/my_utils.js"></script>
	<script src="../js/main.js"></script>
	<script src="../js/admin/admin.js"></script>
	<script src="../js/mydatatable.js"></script>
	<script src="../js/vendor/md5.js"></script>
	<script type="text/javascript">
	var AP_PAGE_PATH='http://www.zhsd168.com/yaojijian/';
	var myform;
	layui.use(['layer', 'form','element'], function(){
        myform=layui.form();
	});
	
	var formValid = true;
	
	$(function(){
		
		$('.form-item .placeholder').click(function(){
			$(this).parent().find('.field').focus();
		});
		
		$('.form-item .field').focus(function(){
			$(this).parent().find('.placeholder').css('display','none');
			if($(this).parent().next('.input-tip').html() == ''){
				$(this).parent().next('.input-tip').html($(this).parent().find('.tip-txt').html());
			}
		});
		$('.form-item .field').blur(function(){
			if($(this).val() == ''){
				$(this).parent().find('.placeholder').css('display','inline');
				$(this).parent().next('.input-tip').empty();
				$(this).parent().removeClass('error');
			}
			var fieldId = $(this).attr('id');
			validateFormData(fieldId);
		});
		
		$('#roleDropmenu').ma_dropmenu({
	        onChange: function (velue, text, $element) {
	        }
	    });
		
		$('#datatable').mydatatable({
			onPage: function(event){
				$('#queryForm input[name="curPage"]').val(event.data.toPage);
				queryList();
			},
			columns:{
				'edit':{'mdata':'<a href="javascript:void(0);" class="btn btn-default"><i class="sublist-icon layui-icon">&#xe642;</i>编辑</a>','callback':showEditPanel}
			}
		});
		queryList();
	});
	
	function queryClick(){
		$('#curPage').val('1');
		queryList();
	}
	
	function queryList(){
		var formdata = $('#queryForm').serialize();
		ANAPP.callSyn({
			url: AP_PAGE_PATH+'api/adminlist',
			data: formdata,
			success: function(rdata){
				if(rdata.isOk == true){
					$('#datatable').mydatatable('refresh', rdata.page);
				}
			}
		});
	}
	
	function addObject(){
		var username = $("#userName").val();
		var pwd = $("#pwd").val();
        var roleType = $("#roleType").val();
		if(username==''){
			layer.alert('用户名不能为空', {icon: 2});
			return false;
		}
        if(roleType==''){
            layer.alert('角色类别不能为空', {icon: 2});
            return false;
        }
		if(pwd==''){
			layer.alert('密码不能为空', {icon: 2});
			return false;
		}
		$('#pwd').val(hex_md5((pwd)));
		var adata = $('#addForm').serialize();
		$.ajax({
			  type: 'POST',
			  url: AP_PAGE_PATH+"aj/adm/save",
			  dataType: 'json',
			  data: adata,
			  async:true,
			  cache:false,
			  beforeSend:function(){
				  index=layer.msg('加载中', {icon: 16});
			  },
			  success: function(data, textStatus, jqXHR){
				if(!!data && data.isOk == true){
					layer.alert('保存成功',{icon: 1});
					window.location = AP_PAGE_PATH+"admin/adm/list";
				}else{
					layer.alert('保存失败',{icon: 2});
				}
			  },error: function(XMLHttpRequest, textStatus, errorThrown){
				    layer.alert('网络异常',{icon: 2});
			  },complete:function(XHR, textStatus){
				  layer.close(index);
			  }
		});
	}

	function manageAdminUser(event){
        var obj = event.data.rowdata;
        var adminId=$("#hid_adminId").val();
        if(obj.id==adminId){
           return true;
		}
		return false;
	}
	
	function removeObjects(){
		var rows = $('#datatable').mydatatable('getCheckRows');
		var datastr = '';
		if(rows.length > 0){
			for(var i=0; i < rows.length; i++){
				if(i == 0){
					datastr += 'adminIds=' + rows[i].id;
				}else{
					datastr += '&adminIds=' + rows[i].id;
				}
			}
		}else{
			layer.alert('未选择任何记录',{icon: 2});
			return false;
		}
		$.ajax({
			  type: 'POST',
			  url: AP_PAGE_PATH+"aj/adm/remove",
			  dataType: 'json',
			  data: datastr,
			  async:true,
			  cache:false,
			  beforeSend:function(){
				  index=layer.msg('加载中', {icon: 16});
			  },
			  success: function(data, textStatus, jqXHR){
				if(!!data && data.isOk == true){
					layer.alert('删除成功',{icon: 1});
					queryList();
				}else{
					layer.alert('删除失败',{icon: 2});
				}
			  },error: function(XMLHttpRequest, textStatus, errorThrown){
				    layer.alert('网络异常',{icon: 2});
			  },complete:function(XHR, textStatus){
				  layer.close(index);
			  }
		});
	}
	
	function showAddPanel(){
		clearFormData();
		$('#userName').prop('readonly', false);
		$('#pwd-item').show();
		hideAllPanel();
		$('#addPanel').show();
	}
	
	function showEditPanel(event){
		clearFormData();
		$('#userName').prop('readonly', true);
		var admin = event.data.rowdata;
		$('#adminId').val(admin.id);
		$('#userName').val(admin.userName);
        $('#phone').val(admin.phone);
        $('#roleType').val(admin.roleType);
		$('#addPanel').find('.field').focus();
        myform.render('select');
		$('#pwd-item').css('display','none');
		hideAllPanel();
		$('#addPanel').show();
	}

	function showUsersPanel(event){
        var admin = event.data.rowdata;
		window.location=AP_PAGE_PATH+"admin/user/adminusers?admin_id"+admin.id;
	}
	
	function clearFormData(){
		$('#pwd').val('');
		$('#userName').val('');
		$('#roleDropmenu').ma_dropmenu('setVal', '2');
		$('#addForm .placeholder').css('display','inline');
	}
	
	function returnToList(){
		hideAllPanel();
		$('#listPanel').show();
	}
	
	function hideAllPanel(){
		$('#listPanel, #addPanel').hide();
	}
	</script>
</body>
</html>